# 网格交易工具

## 描述

网格交易工具是一个功能强大的应用程序，具有用户友好的图形界面，用于创建、可视化和管理网格交易策略。它允许用户输入总资金、初始价格、止损价格、网格数量和分配方法等参数，以生成定制的网格交易计划。

## 免责声明

重要提示：本软件仅供教育和信息目的使用。它不应被视为财务建议或作为做出任何具体投资决策的推荐。

使用本工具涉及重大财务风险。网格交易和其他投资策略可能导致巨大损失，尤其是在市场波动的情况下。本软件的作者不对使用本工具导致的任何财务损失或损害负责。

使用本软件即表示您承认：

1. 您对自己做出的任何投资决策完全负责。
2. 您了解交易和投资所涉及的风险。
3. 您不会因使用本软件而造成的任何损失或损害追究作者的责任。
4. 在做出任何投资决策之前，建议您寻求持牌金融专业人士的建议。

作者不对本工具提供的信息的准确性、可靠性或完整性做出任何保证。市场条件可能迅速变化，过去的表现不能保证未来的结果。

使用本软件风险自负。

## 特性

- 多种分配方法：等额分配、比例分配和线性加权分配
- 实时获取常用股票价格
- 动态常用股票按钮和实时状态栏，提供即时反馈
- 配置保存/加载和交易计划的CSV导出
- 用户友好的GUI，布局直观
- 自动检查更新并安装
- 支持Yahoo Finance和Alpha Vantage API进行股票数据检索
- 交易指令解析，实现快速灵活的计划生成
- 价格容差检查和止损价格的自动调整
- 用户特定的配置文件，实现个性化设置
- 增强的Moomoo API集成，提供实时交易能力和账户信息
- 支持美股和港股市场的真实和模拟交易环境
- 账户查询功能，包括可用资金、股票持仓和历史订单
- 能够基于计算的交易计划下单
- 强制模拟模式切换，确保测试安全

## 项目结构

```plaintext
grid-trading-tool/
├── src/
│   ├── __init__.py
│   ├── api_interface.py
│   ├── api_manager.py
│   ├── calculations.py
│   ├── config.py
│   ├── gui.py
│   ├── status_manager.py
│   └── utils.py
├── tests/
│   ├── test_calculations.py
│   └── test_instruction_parsing.py
├── assets/
│   └── icons/
│       └── app_icon.ico
├── logs/
├── output/
├── scripts/
│   ├── build_exe.py
│   └── generate_project_structure.py
├── .github/
│   └── workflows/
│       └── python-app.yml
├── grid_trading_app.py
├── config.ini
├── CHANGELOG.md
├── LICENSE
├── README.md
├── README-zh-CN.md
├── userconfig.ini.template
├── requirements.txt
└── version.py
```

## 安装

### Windows用户

1. 前往[发布页面](https://github.com/znhskzj/grid-trading-plan-calculator/releases)。
2. 下载最新的`.exe`文件。
3. 双击下载的文件即可运行应用程序。

### 开发者

如果您想从源代码运行脚本或为项目做出贡献：

1. 确保已安装 Python 3.7 或更高版本。
2. 克隆仓库：
git clone https://github.com/znhskzj/grid-trading-plan-calculator.git
3. 进入项目目录：
cd grid-trading-plan-calculator
4. 创建虚拟环境：
python -m venv venv
5. 激活虚拟环境：
- Windows: `venv\Scripts\activate`
- macOS 和 Linux: `source venv/bin/activate`
6. 安装所需包：
pip install -r requirements.txt
7. 运行脚本：
python grid_trading_plan.py

## 使用说明

1. 启动应用程序：双击可执行文件，或如果使用源代码，运行 `python grid_trading_app.py`。

2. 在主窗口中：
   - 左侧面板显示常用股票按钮。
   - 右侧面板包含输入字段、控制按钮和设置。

3. 点击"常用股票"查看和选择预定义的股票：
   - 点击股票代码（如 AAPL、GOOGL）将自动获取其当前价格。

4. 输入交易参数：
   - 可用资金：输入您想投资的总金额。
   - 初始价格：如果选择了股票，此项会自动填充，或者您可以手动输入。
   - 止损价格：输入您想要退出交易以限制损失的价格。
   - 网格数量：输入您的网格策略的价格级别数量。

5. 选择分配方法：
   - 等额分配：在所有网格间平均分配资金。
   - 比例分配：为靠近当前价格的网格分配更多资金。
   - 线性加权：随着价格远离初始价格，逐渐增加分配。

6. 选择 API 来源：
   - 在 Yahoo Finance 和 Alpha Vantage 之间选择股票数据获取源。

7. 配置 Moomoo 设置：
   - 选择真实或模拟交易环境。
   - 选择美股或港股市场。
   - 点击"测试连接"验证 Moomoo API 连接性。

8. 点击"计算购买计划"生成网格交易计划。

9. 在下方的文本区域查看结果：
   - 计划将显示总资金、保留资金（如果有）、可用资金，以及每个网格的分配。

10. 其他选项：
    - "保留 10% 计算"或"保留 20% 计算"：生成保留部分资金的计划。
    - "保存为 CSV"：将当前计划导出为 CSV 文件，用于进一步分析或记录。
    - "重置为默认值"：重置输入字段，同时保留常用股票和 Moomoo 设置。

11. 交易指令解析：
    - 在指定字段输入交易指令，以基于指令生成计划。
    - 应用程序将解析指令并相应地生成计划。

12. 自动更新：
    - 应用程序将定期检查更新。
    - 如果有可用更新，您将收到下载和安装的提示。

13. 查询账户信息
    - 确保您已在设置中正确配置 Moomoo API 连接。
    - 点击"查询可用资金"按钮，查看当前账户余额和可用资金。
    - 使用"查询股票持仓"按钮，查看当前持股的详细信息，包括：
      - 股票代码
      - 持有数量
      - 当前市值
      - 盈亏比例
    - 点击"查询历史订单"按钮查看您的近期交易历史。
    - 使用"按计划下单"按钮根据您计算的交易计划执行订单。

14. 强制模拟模式
   - 切换"强制模拟模式"按钮，确保所有操作都在模拟环境中执行，在测试和学习过程中提供额外的安全层。

### Moomoo API 集成

- 工具支持真实和模拟交易环境。
- 您可以在Moomoo设置中切换美股和港股市场。
- 增强的功能包括查询账户信息、股票持仓和历史订单。
- 能够直接根据计算的交易计划下单。
- 执行任何操作前，务必先测试API连接。
- 使用强制模拟模式进行安全测试和学习。
- 确保您的Moomoo账户具有执行所需操作的必要权限。

### 使用示例

假设您想为苹果（AAPL）股票创建一个网格交易计划：

1. 启动应用程序。
2. 点击"常用标的"，然后点击"AAPL"。
3. AAPL 的当前价格将自动获取（假设是150元）。
4. 输入以下内容：
   - 可用资金：10000（假设您想投资10,000元）
   - 初始价格：150（从获取的价格自动填充）
   - 止损价格：140（您决定如果价格降到140元就止损）
   - 网格数量：5（您想要5个价格级别的网格）
5. 选择"等比例分配"作为分配方式。
6. 点击"计算购买计划"。
7. 结果将显示140元到150元之间的5个价格级别，靠近150元的网格分配更多资金。
8. 如果您对计划满意，点击"保存为CSV"导出它。
9. 您现在可以选择使用 Yahoo Finance 或 Alpha Vantage 的 API 来获取股票数据。
10. 您选择的 API 和常用股票现在会自动保存，以便在下次使用时恢复。

## 配置

项目根目录中的 `config.ini` 文件包含默认设置和常用股票。您可以修改此文件来自定义应用程序的默认行为并添加或删除常用股票。
config.ini 文件现在包含 API 设置。您可以选择使用 Yahoo Finance 或 Alpha Vantage 来获取股票价格数据。如果您选择 Alpha Vantage，则需要提供 API 密钥。

### 配置示例

以下是 `config.ini` 的一个示例：

```ini
[General]
funds = 50000.0
initial_price = 50.0
stop_loss_price = 30.0
num_grids = 10
allocation_method = 1

[CommonStocks]
stock1 = AAPL
stock2 = GOOGL
stock3 = MSFT
stock4 = AMZN
stock5 = TSLA

[API]
choice = yahoo
alpha_vantage_key = your_alpha_vantage_key_here
```

### 自定义方法：

* 在文本编辑器中打开 config.ini。
* 在 [General] 下，根据需要修改默认值：

funds：默认可用资金
initial_price：默认初始价格
stop_loss_price：默认止损价格
num_grids：默认网格数量
allocation_method：默认分配方式（0 为等金额，1 为等比例，2 为线性加权）


* 在 [CommonStocks] 下，添加或删除股票：

要添加新股票，添加新行：stockX = 股票代码（将 X 替换为下一个数字，股票代码替换为实际的股票代码）
要删除股票，删除相应的行

修改后保存文件。下次启动应用程序时，将使用这些新的默认值和常用股票列表。

## 即将推出的功能

- 用户特定的配置文件，用于个性化设置
- 基于用户偏好的可自定义自动更新检查
- Moomoo 交易平台集成，实现实时交易功能

## 许可证

本项目采用 MIT 许可证。详情请见 [LICENSE](LICENSE) 文件。

## 贡献

欢迎贡献！请随时提交 Pull Request。

## 支持

如果您遇到任何问题，请提交 issue 并附上详细描述。

有关详细的发布说明，请查看[更新日志](CHANGELOG.md)。
